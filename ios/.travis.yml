language: objective-c
osx_image: xcode9.3
branches:
  only:
  - master
  - develop
  - /^release.*$/
before_install:
- export SIMULATOR_UDID=`instruments -s devices | grep "iPhone SE (11.3" | awk -F '[ ]' '{print $4}' | awk -F '[\[]' '{print $2}' | sed 's/.$//'`
- open -a "simulator" --args -CurrentDeviceUDID $SIMULATOR_UDID & # warm up the simulator
before_script:
- ./scripts/configure_keychain.sh
- gem install bundler
- gem install xcpretty
script:
  - ./scripts/build.sh
  - ./scripts/test.sh
after_success:
- sleep 10 # https://github.com/travis-ci/travis-ci/issues/4725
- ./scripts/hockey_upload.sh
env:
  global:
  - APP_NAME="Enterprise"
  - XCODE_CONFIGURATION="UAT"
  - PROFILE_NAME="Enterprise"
  - CRITTERCISM_APP_ID="52fb93bc97c8f26539000004"
  - CRITTERCISM_API_KEY="f44b7917d02adccef68dee886b91686f"
  # KEY_PASSWORD
  - secure: "i6J6aBSOEPQIl7j/b27w5/Tj8LJjjTmYczz10TSzTm3/cAfzzSLXt7m5GbVCemRh5jhABqtXE7RXDR1pauKG4F5N6IQqSLq/BRF0on6Ubj1XGprPE8RtzNPbORTP+9bkexFhCSNbvP2cf+BiVFDJh9AbFw3xuovGjRB/rIgl+NXhtZjq+xfQvuZmNGTcWlw5OP3zRwTAawCsWzgZIo5u+59tNqVDaTC6T1dP6qWR3bMdR4QRoWK063Pyoj2RuNknwox9I6xbgQEf4E24y3g0pihIALLDgThOsTIXdiL3cTXiWzY2AGMc/pN1PBouqpguFUM9bOEimyb6iOu/Cg1Nn6/t2D7l7X/GUV9PtfLW+HxRh5xH5N+AqwTnu380etmOlv/sXkYDCLMTkCIQ2rbk8LtNqMayKtpCAiMa8mR62e5uMmYBT1rfKAcRbKZVtvU+F0ljBQHZZLhUCiXadAEFiR14ckyI1YQlRjhpMG9qqXYYR3iiXDuAPIzLtHr+A2PRvNf27W7SXVe2k3N2icI8ys+WT3hqAFlKQ7TabLpxZrHpAqe+96NEAaTavNDyoucpJcv/J5ZeBo/3Io9g2nNZQ7G2k+gXm5H6+T/O480dswLwMjhanJl4yY3N7lKqznnHabXTrZsRE5GS0w5x1AEQ/oCq9nNDWaA0Kkv9X+WQGOU="
  # HOCKEY_API_KEY
  - secure: "p6xoZ+oZ9RDTY477KYLHSi/AlF3hq2xSLVz8H4kREHQ3ON5HK4SLi7V+HrJefjF/Zkkd4kEHUPNtW2ayQtDh5Tk3Jpm0Zmrf6TG+sEYpI9tBPmBHCm3Ylq9M7xeBHgkXsE0IJ/bIOHtpNZUG6NG8aRn6ESvZ8jXA4vxzS/S3FspnEe98ZxE5lZfPLmQCErP07hBRPDR0bk6+sEiHbYwaHq7+GuOinS//U9PeyzonDyp6G5Z0ro+Ypiil/7nH3yixcfggNNXfIqtzOjuJpyqaBYp1if3KC0SQDsZ5zqK3gSuv9dNJq8IpubFkLAubZ0nohIibrwOo2VNoS50J2WVUZlstBmFMwiy7inZgnyJ+kKrocNISBPjbq738anmtz7FhMljS32kFxYXJ5UHtcaBQGlWpQG5xwILQCiwgGQiOJgI1Z3fMBd6dIMm91HYEdQ0JhPegI0sJ3ZkcqK506nNkjMY4NIUDi3gWKGMDBTWt/gJOV+t91Cd7WOlgVf3hFASDD3SzRv9lvoNFdbtWEjdBav4BSG/K13qrnQVJVyJy/UmRzd5lqE4dwX78hAxd2pHfyY2ApZ0ZOEmZKYI5Qi5g88QmFTPi6J6GnIMm6cz9gsqXE/2MoIEklHvqXV4LqzYrOUcUwoh+zgINhj9qf0yCqaGPlTlBBlH9lKi4WXP+oKs="

notifications:
  slack: "isobar-us:pCKpgFvEFe9q3dcT9rZvxhOK"
